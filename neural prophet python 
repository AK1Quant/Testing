import pandas as pd
from neuralprophet import NeuralProphet
from sklearn.metrics import mean_absolute_percentage_error

# Load your data
# Assuming your data is in a CSV file named 'us_vix.csv' with columns 'date' and 'vix'
data = pd.read_csv('us_vix.csv', parse_dates=['date'])
data.columns = ['ds', 'y']  # Rename columns for NeuralProphet

# Initialize NeuralProphet model
model = NeuralProphet()

# Fit the model
model.fit(data, freq='D')

# Make predictions
future = model.make_future_dataframe(data, periods=30)
forecast = model.predict(future)

# Calculate MAPE on the training data
train_forecast = model.predict(data)
mape = mean_absolute_percentage_error(data['y'], train_forecast['yhat1'])
print(f'MAPE: {mape}')

# Print the future predictions
print(forecast[['ds', 'yhat1']].tail(30))
