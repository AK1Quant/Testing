---
title: "Download .xlsx File"
output: flexdashboard::flex_dashboard:
  orientation: columns
  vertical_layout: fill
runtime: shiny
---

Column {.sidebar}
---

```{r}
library(shiny)
library(openxlsx)
library(flexdashboard)

ui <- fluidPage(
  downloadButton("downloadData", "Download .xlsx")
)

server <- function(input, output) {
  # Reactive function to create data
  data <- reactive({
    mtcars
  })
  
  # Define download handler
  output$downloadData <- downloadHandler(
    filename = function() {"mtcars.xlsx"},
    content = function(file) {
      write.xlsx(data(), file)
    }
  )
}

shinyApp(ui = ui, server = server)
